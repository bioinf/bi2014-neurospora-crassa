
Установка сторонних программ
=================================

Переменные окружения
-------------------------

В программе на _python_ используются переменные для хранения необходимых для выполнения
данных (счетчики, значения подвыражений, введенная пользователем строка). Точно так же
в операционных системах (ОС) (Linux, Windows) используются т.\ н. _переменные окружения_
для хранения необходимых ОС данных. Значения всех этих переменных можно увидеть, запустив
команду `printenv`:

~~~bash
$ printenv
...
PATH=/usr/local/bin:/usr/bin:/bin:...
...
~~~

Значение конкретной переменной можно узнать, передав в качестве параметра `printenv` имя
этой переменной:

~~~bash
$ printenv
$ printenv WISECONFIGDIR
/home/me/soft/wise/wisecfg
~~~

Переменная окружения `PATH`
--------------------------------
При запуске какой-либо программы в _Bash_, например:

~~~bash
$ less
...
~~~

_Bash_ ищет файл с именем программы во всех директориях, которые содержатся в переменной окружения
`PATH`, затем найденный файл исполняет. Узнать, какой именно файл будет исполнен можно
 командой `which`:

~~~bash
$ which less
/usr/bin/less
~~~

Использовать значение переменной окружения `PATH` можно, например, в команде `echo`:

~~~bash
$ echo "All paths I know:  $PATH"
~~~

Команда `echo` выводит переданную ей в аргументах строку.

__Замечание!__ В _Bash_ всегда можно получить значение
переменной окружения, добавив знак __$__ перед именем переменной.
Предыдущий пример вполне соответствует следующему коду на _python_:

~~~python
print("All paths I know: " + path)
~~~

__Замечание!__ В качестве разделителей путей в `PATH` используется символ двоеточия.

Модификация `PATH`
---------------------
Предположим, что у нас где-то лежит программа с исполняемыми файлами.
Например, в папке `/home/me/Downloads/ncbi-blast/bin/` лежит файл `blastall`. И мы
бы хотели иметь возможность запускать `blastall` также просто, как `echo` или `less`, т. е.:

~~~bash
$ blastall ...
~~~

Для этого, как мы уже знаем, достаточно добавить папку `/home/me/Downloads/ncbi-blast/bin/` в `PATH`.
Это можно сделать, выполнив в \emph{Bash} следующую команду:

~~~bash
$ export PATH="$PATH:/home/me/Downloads/ncbi-blast/bin"
~~~

Команда `export` позволяет изменить значения переменных окружения для __текущей__ консоли.
Она принимает произвольно число аргументов вида `VARIABLE=VALUE`. После выполнения данной строчки кода
в __текущей__ консоли поставленная задача будет выполнена (мы можем запускать `blastall`).

__Внимание!__ Наличие кавычек обязательно, т.к. `PATH` и реальное имя
добавляемой папки может содержать пробел, остаток строки после которого
будет интерпретирован как следующие аргументы к команде `export`,
а обособленная кавычками строка всегда интерпретируется как одно целое.

__Внимание!__ Необходимо оставлять в `PATH` предыдущее его содержимое, т. к. иначе
все остальные программы могут перестать запускаться (т. к. _Bash_ не будет знать, где
лежат соответствующие им исполняемые файлы).

Перманентная модификация `PATH`
-------------------------------------
Проблема предыдущего решения в том, что стоит нам открыть другую консоль, мы столкнемся с тем, что
значение `PATH` там осталось неизменным. Нужен способ, который позволил бы изменить переменную
окружения для всех запускаемых консолей. В этом нам поможет следующий факт.

Почти каждый раз при запуске нового "окна" _Bash_, до передачи управления пользователю,
исполняется содержимое файла `~/.bashrc`. Поэтому, если мы добавим в файл `~/.bashrc`
(создав его при необходимости) следующую строчку:

~~~bash
export PATH="$PATH:/home/me/Downloads/ncbi-blast/bin"
~~~

В каждой новой запущенной консоли значение переменной `PATH` будет иметь нужное нам значение.

Установка приложений
========================
Предположим, что мы хотим установить какую-либо программу (например, биоинформатическую утилиту).

Установка из репозитория
---------------------------
Первое, что нужно сделать --- это проверить, не присутствует ли данная программа в виде готового
пакета в репозитории используемого вами дистрибутива _Linux_. В _Ubuntu_ для этого есть команда
`apt-cache`

~~~bash
$ apt-cache search имя_программы
~~~

Если нам удалось подтвердить наличие необходимого пакета в репозитории, тогда выполняем
установку найденного пакета. В _Ubuntu_ используем `apt-get`:

~~~bash
$ sudo apt-get install имя_пакета
~~~

Установка с сайта разработчика
----------------------------------
Иногда, предыдущий пункт нам не подходит. Это может произойти по разным причинам:

 * программа отсутствует в репозитории;
 * версия программы в репозитории старее/новее, чем нужно.

В такой ситуации зачастую можно скачать требуемую версию программы с сайта разработчика.

Пусть требуемая программа --- это самый последний _BLAST+_. На
сайте _NCBI_ есть соответствующая страница загрузки
[Blast Download][], ссылка `.../LATEST/` приведет к доступным для
скачивания вариантам (_BLAST+_ --- это только пример, большая часть
последующего материала подходит для любого приложения).

Какие бывают наиболее часто встречающиеся варианты:

 1. __Исходный код__ --- содержащие `src` в своем имени
 2. __Пакеты для установки__ --- оканчивающиеся на `.dmg`
  (_Mac OS X_), `.deb` (_Ubuntu_), `.rpm` (_Cent OS_), ~~`.exe` (_Windows_)~~.
 3. __Готовая к запуску программа__ -- обычно не является ни одним из
  перечисленных, имеет расширение `.tar.gz` или `.zip`.

При этом стоит обращать внимание на разрядность вашей операционной
системы: 32 или 64 бита. 32-х битные версии для скачивания обычно
обозначаются как __x86__, __ia32__, __i686__ ~~или
__win32__~~; а 64-х битные как __amd64__, __x86-64__
~~или __win64__~~.

Установка бинарных пакетов
-------------------------------

Если доступен вариант 2, который подходит к вашему дистрибутиву, то
лучше использовать его, т. к. он содержит информацию о сторонних
библотеках, требуемых для работы программы, которые ваша операционная
система может загрузить самостоятельно.

В таком случае, для установки обычно достаточно скачать и запустить файл пакета.

Установка готовой программы
--------------------------------

Если доступен вариант 3, тогда скачиваем архив с файлом, следя за
версией операционной системы. В примере с _BLAST+_: если у меня
64-битный _Linux_, то я скачиваю файл `ncbi-blast-2.2.29+-x64-linux.tar.gz`,

Далее файл необходимо распаковать. Рекомендуется распаковывать все программы в специльно созданную для
этого папку, например `~/soft` или `~/libs`. Для каждого формата архива используется своя команда:

~~~bash
$ tar -xzvf file.tar.gz
$ tar -xjvf file.tar.bz2
$ unzip file.zip
~~~

После распаковки можно добавить директорию и исполняемыми файлами программы в переменную `PATH`,
как было рассказано ранее.

__Внимание!__ Это обобщенное руководство по установке, которое работает в большом числе стандартных
ситуаций. На сайте разработчика вполне могут встретиться какие-то специфические инструкции и
рекомендации. С ними обязательно следует проконсультироваться (особенно, если что-то не работает ☺).


Установка зависимостей
-------------------------
Несмотря на то, что мы все скачали, распаковали, `PATH` обновили, программа все равно 
может не запускаться, т. к. какая-либо из требуемых ей для работы библиотек не была установлена.

Какие именно требуются зависимости можно узнать опять таки на сайте разработчика, или же
прочитать файлы `README` или `INSTALL` из загруженного архива программы.

Также, на крайний случай, можно попробовать запустить программу и надеяться на то, что она
отработает как надо. Даже если произойдет ошибка, то огорчаться не стоит, т.\ к. из сообщений об ошибках зачастую можно узнать имя неустановленной зависимости.

После того, как мы знаем, какие нужны зависимости, можно данную инструкцию применить уже к ним.

[Blast Download]: http://blast.ncbi.nlm.nih.gov/Blast.cgi?CMD=Web&PAGE_TYPE=BlastDocs&DOC_TYPE=Download
